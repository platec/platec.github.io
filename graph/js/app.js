(function(){"use strict";var e={167:function(e,t,i){var s=i(963),r=i(252);const n={class:"container",ref:"container"};function a(e,t){return(0,r.wg)(),(0,r.iD)("div",n,null,512)}function o(e){return e instanceof l}class l{constructor(e){Object.defineProperty(this,"_datas",{enumerable:!0,configurable:!0,writable:!0,value:[]});const t=arguments.length;if(1===t){const e=arguments[0];if(o(e)){const t=e.size();for(let i=0;i<t;i++)this._datas.push(e.get(i))}else if(Array.isArray(e)){const t=e.length;for(let i=0;i<t;i++)this._datas.push(e[i])}else null!==e&&this._datas.push(e)}else if(t>1)for(let i=0;i<t;i++)this._datas.push(arguments[i])}push(...e){const t=e.length;for(let i=0;i<t;i++)this.add(e[i])}pop(){return this._datas.pop()}shift(){return this._datas.shift()}unshift(...e){this._datas.unshift.apply(this._datas,e)}size(){return this._datas.length}isEmpty(){return 0===this._datas.length}add(e,t){void 0===t?this._datas.push(e):this._datas.splice(t,0,e)}addAll(e){if(Array.isArray(e)){const t=e,i=t.length;for(let e=0;e<i;e++)this._datas.push(t[e])}else if(o(e)){const t=e,i=t.size();for(let e=0;e<i;e++)this._datas.push(t.get(e))}}get(e){return this._datas[e]}slice(e,t){return new l(this._datas.slice(e,t))}remove(e){const t=this._datas.indexOf(e);if(t>=0)return this.removeAt(t),t}set(e,t){return this._datas[e]=t}clear(){return this._datas.splice(0,this._datas.length)}contains(e){return this._datas.includes(e)}indexOf(e){return this._datas.indexOf(e)}removeAt(e){return this._datas.splice(e,1)[0]}forEach(e,t){this.each(e,t)}each(e,t){const i=this._datas.length;for(let s=0;s<i;s++){const i=this._datas[s];t?e.call(t,i,s,this):e(i,s,this)}}reverseEach(e,t){for(let i=this._datas.length-1;i>=0;i--){const s=this._datas[i];t?e.call(t,s):e(s)}}getArray(){return this._datas}toArray(e,t){if(e){const i=[],s=this._datas.length;for(let r=0;r<s;r++){const s=this._datas[r];t?e.call(t,s)&&i.push(s):e(s)&&i.push(s)}return i}return this._datas.concat()}toList(e,t){if(e){const i=new l,s=this._datas.length;for(let r=0;r<s;r++){const s=this._datas[r];t?e.call(t,s)&&i.add(s):e(s)&&i.add(s)}return i}return new l(this)}reverse(){this._datas.reverse()}sort(e){return e?this._datas.sort(e):this._datas.sort(),this}toString(){return this._datas.toString()}}class h{constructor(){Object.defineProperty(this,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Data"}),Object.defineProperty(this,"_notifier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getId(){return this._id}setId(e){this._id=e}setNotifier(e){this._notifier=e}update(){this._notifier&&this._notifier.emitNextTick("render")}}class c extends h{constructor(){super(),Object.defineProperty(this,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Node"}),Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_displayName",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_styleMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_anchorX",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(this,"_anchorY",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(this,"_rotation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_scaleX",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_scaleY",{enumerable:!0,configurable:!0,writable:!0,value:1})}getPostion(){return{x:this._x,y:this._y}}setPosition(e){this._x=e.x,this._y=e.y,this.update()}getWidth(){return this._width}setWidth(e){this._width=e,this.update()}getHeight(){return this._height}setHeight(e){this._height=e,this.update()}getImage(){return this._image}setImage(e){this._image=e,this.update()}getDisplayName(){return this._displayName}setDisplayName(e){this._displayName=e,this.update()}getSize(){if(void 0===this._width||void 0===this._height){const e=m(this.getImage());return{width:e.width,height:e.height}}return{width:this._width,height:this._height}}setSize(e,t){this._width=e,this._height=t}getRect(){const{x:e,y:t}=this.getPostion(),{width:i,height:s}=this.getSize();let{x:r,y:n}=this.getAnchor();r=void 0===r?b.anchorX:r,n=void 0===n?b.anchorY:n;const{x:a,y:o}=this.getScale();return{x:e-i*Math.abs(a)*r,y:t-s*Math.abs(o)*n,width:i*Math.abs(a),height:s*Math.abs(o)}}setRect(e,t,i,s){this._x=e,this._y=t,this._width=i,this._height=s,this.update()}setStyle(e,t){if(void 0!==t&&"string"===typeof e)this._styleMap.set(e,t);else if("object"===typeof e&&Object.keys(e).length>0)for(const i in e)this._styleMap.set(i,e[i]);this.update()}getStyle(e){return this._styleMap.get(e)}getAnchor(){return{x:this._anchorX,y:this._anchorY}}setAnchor(e){this._anchorX=e.x,this._anchorY=e.y,this.update()}getRotation(){return this._rotation}setRotation(e){this._rotation=e,this.update()}setScale(e){this._scaleX=e.x,this._scaleY=e.y,this.update()}getScale(){return{x:this._scaleX,y:this._scaleY}}setScaleX(e){this._scaleX=e,this.update()}setScaleY(e){this._scaleY=e,this.update()}getScaleX(){return this._scaleX}getScaleY(){return this._scaleY}}class u extends h{constructor(){super(),Object.defineProperty(this,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Text"}),Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_styleMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_anchorX",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(this,"_anchorY",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(this,"_rotation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_scaleX",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_scaleY",{enumerable:!0,configurable:!0,writable:!0,value:1})}getPostion(){return{x:this._x,y:this._y}}setPosition(e){this._x=e.x,this._y=e.y,this.update()}getWidth(){return this._width}setWidth(e){this._width=e,this.update()}getHeight(){return this._height}setHeight(e){this._height=e,this.update()}getSize(){return{width:this._width,height:this._height}}setSize(e,t){this._width=e,this._height=t}getRect(){const{x:e,y:t}=this.getPostion(),{width:i,height:s}=this.getSize();let{x:r,y:n}=this.getAnchor();return r=void 0===r?b.anchorX:r,n=void 0===n?b.anchorY:n,{x:e-i*r,y:t-s*n,width:i,height:s}}setRect(e,t,i,s){this._x=e,this._y=t,this._width=i,this._height=s,this.update()}setStyle(e,t){if(void 0!==t&&"string"===typeof e)this._styleMap.set(e,t);else if("object"===typeof e&&Object.keys(e).length>0)for(const i in e)this._styleMap.set(i,e[i]);this.update()}getStyle(e){return this._styleMap.get(e)}getAnchor(){return{x:this._anchorX,y:this._anchorY}}setAnchor(e){this._anchorX=e.x,this._anchorY=e.y,this.update()}getRotation(){return this._rotation}setRotation(e){this._rotation=e,this.update()}setScale(e,t){this._scaleX=e,this._scaleY=t,this.update()}getScale(){return{x:this._scaleX,y:this._scaleY}}setScaleX(e){this._scaleX=e,this.update()}setScaleY(e){this._scaleY=e,this.update()}getScaleX(){return this._scaleX}getScaleY(){return this._scaleY}}class d extends h{constructor(){super(),Object.defineProperty(this,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Edge"}),Object.defineProperty(this,"_styleMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_source",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_target",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}setStyle(e,t){if(void 0!==t&&"string"===typeof e)this._styleMap.set(e,t);else if("object"===typeof e&&Object.keys(e).length>0)for(const i in e)this._styleMap.set(i,e[i]);this.update()}getStyle(e){return this._styleMap.get(e)}setSource(e){this._source=e,this.update()}setTarget(e){this._target=e,this.update()}getSource(){return this._source}getTarget(){return this._target}}class g extends h{constructor(){super(),Object.defineProperty(this,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Shape"}),Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_closePath",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_styleMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_segments",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_points",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_anchorX",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(this,"_anchorY",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(this,"_rotation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_scaleX",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_scaleY",{enumerable:!0,configurable:!0,writable:!0,value:1})}getPostion(){return{x:this._x,y:this._y}}setPosition(e){this._x=e.x,this._y=e.y,this.update()}getWidth(){return this._width}setWidth(e){this._width=e,this.update()}getHeight(){return this._height}setHeight(e){this._height=e,this.update()}getPoints(){return this._points}setPoints(e){this._points=e,this.update()}getSegments(){return this._segments}setSegments(e){this._segments=e,this.update()}isClosePath(){return void 0===this._closePath||this._closePath}setClosePath(e){this._closePath=e,this.update()}getSize(){return{width:this._width,height:this._height}}setSize(e,t){this._width=e,this._height=t}getRect(){const{x:e,y:t}=this.getPostion(),{width:i,height:s}=this.getSize();let{x:r,y:n}=this.getAnchor();return r=void 0===r?b.anchorX:r,n=void 0===n?b.anchorY:n,{x:e-i*r,y:t-s*n,width:i,height:s}}setRect(e,t,i,s){this._x=e,this._y=t,this._width=i,this._height=s,this.update()}setStyle(e,t){if(void 0!==t&&"string"===typeof e&&this._styleMap.set(e,t),e&&Object.keys(e).length>0)for(const i in e)this._styleMap.set(i,e[i]);this.update()}getStyle(e){return this._styleMap.get(e)}getAnchor(){return{x:this._anchorX,y:this._anchorY}}setAnchor(e){this._anchorX=e.x,this._anchorY=e.y,this.update()}getRotation(){return this._rotation}setRotation(e){this._rotation=e,this.update()}setScale(e,t){this._scaleX=e,this._scaleY=t,this.update()}getScale(){return{x:this._scaleX,y:this._scaleY}}setScaleX(e){this._scaleX=e,this.update()}setScaleY(e){this._scaleY=e,this.update()}getScaleX(){return this._scaleX}getScaleY(){return this._scaleY}}class b{}function f(e,t){const i=t;if(i.className){e.fillStyle=i.getStyle("shape.background")||b.backgroundColor,e.strokeStyle=i.getStyle("shape.border.color")||b.borderColor;const t=i.getStyle("shape.border.width");e.lineWidth=void 0===t||t<0?0:t,e.lineJoin=i.getStyle("shape.border.join")||b.borderJoin,e.lineCap=i.getStyle("shape.border.cap")||b.borderCap}else{const i=t;e.fillStyle=i.background||b.backgroundColor,e.strokeStyle=i.borderColor||b.borderColor,void 0===i.borderWidth||i.borderWidth<0?e.lineWidth=0:e.lineWidth=i.borderWidth,e.lineJoin=i.borderJoin||b.borderJoin,e.lineCap=i.borderCap||b.borderCap}}Object.defineProperty(b,"borderColor",{enumerable:!0,configurable:!0,writable:!0,value:"#979797"}),Object.defineProperty(b,"backgroundColor",{enumerable:!0,configurable:!0,writable:!0,value:"transparent"}),Object.defineProperty(b,"borderWidth",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(b,"font",{enumerable:!0,configurable:!0,writable:!0,value:"12px arial, sans-serif"}),Object.defineProperty(b,"align",{enumerable:!0,configurable:!0,writable:!0,value:"left"}),Object.defineProperty(b,"vAlign",{enumerable:!0,configurable:!0,writable:!0,value:"middle"}),Object.defineProperty(b,"borderJoin",{enumerable:!0,configurable:!0,writable:!0,value:"round"}),Object.defineProperty(b,"borderCap",{enumerable:!0,configurable:!0,writable:!0,value:"butt"}),Object.defineProperty(b,"fillRule",{enumerable:!0,configurable:!0,writable:!0,value:"evenodd"}),Object.defineProperty(b,"fontColor",{enumerable:!0,configurable:!0,writable:!0,value:"black"}),Object.defineProperty(b,"text",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(b,"symbolWidth",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(b,"symbolHeight",{enumerable:!0,configurable:!0,writable:!0,value:100}),Object.defineProperty(b,"anchorX",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(b,"anchorY",{enumerable:!0,configurable:!0,writable:!0,value:.5}),Object.defineProperty(b,"scaleX",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(b,"scaleY",{enumerable:!0,configurable:!0,writable:!0,value:1});const _={Node:c,Text:u,Edge:d,Shape:g};function y(e){return _[e]}const p=new Map;function v(e,t){p.set(e,t)}function m(e){return p.get(e)}function w(e){return"set"+e.charAt(0).toUpperCase()+e.slice(1)}function x(e,t){let i,s;return t.pageX||t.pageY?(i=t.pageX,s=t.pageY):(i=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),i-=e.offsetLeft,s-=e.offsetTop,{x:i,y:s}}function P(e,t,i){return!(t<e.x||t>e.x+e.width||i<e.y||i>e.y+e.height)}function S(e,t,i){const s=(e.x-t.x)*Math.cos(i)-(e.y-t.y)*Math.sin(i)+t.x,r=(e.x-t.x)*Math.sin(i)+(e.y-t.y)*Math.cos(i)+t.y;return{x:s,y:r}}class j{constructor(){Object.defineProperty(this,"_events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isWaiting",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this._events=Object.create(null)}on(e,t){if(Array.isArray(e))for(let i=0,s=e.length;i<s;i++)this.on(e[i],t);else(this._events[e]||(this._events[e]=[])).push(t);return this}off(e,t){if(!arguments.length)return this._events=Object.create(null),this;if(Array.isArray(e)){for(let i=0,s=e.length;i<s;i++)this.off(e[i],t);return this}const i=this._events[e];if(!i)return this;if(!t)return this._events[e]=null,this;let s,r=i.length;while(r--)if(s=i[r],s===t||s.fn===t){i.splice(r,1);break}return this}once(e,t){const i=this;function s(){i.off(e,t),t.apply(i,arguments)}return s.fn=t,this.on(e,s),this}emit(e){const t=this._events[e];if(t){const e=Array.from(arguments).slice(1);for(let i=0,s=t.length;i<s;i++)t[i].apply(this,e)}return this}emitNextTick(e){this._isWaiting||(this._isWaiting=!0,requestAnimationFrame((()=>{this.emit(e),this._isWaiting=!1})))}}function O(e,t){const i=t;if(i.className){const i=t,s=i.getStyle("shape.border.width");void 0!==s&&e.stroke()}else{const i=t;void 0!==i.borderWidth&&e.stroke()}e.fill()}function k(e,t){const i=t.getRotation();if(i){const{x:s,y:r}=t.getPostion();e.translate(s,r),e.rotate(i),e.translate(-s,-r)}}function M(e,t){const{x:i,y:s}=t.getScale();if(1!==i||1!==s){const{x:r,y:n,width:a,height:o}=t.getRect();let l=r,h=n;i<0&&(l=r+a/(1-i)),s<0&&(h=n+o/(1-s)),e.translate(l,h),e.scale(i,s),e.translate(-l,-h)}}function X(e,t){k(e,t),M(e,t);const{x:i,y:s,width:r,height:n}=t.getRect();if(e.translate(i,s),"Node"===t.className){const i=t.getImage();if(i&&i.endsWith(".json")){const t=m(i),s=r/t.width,a=n/t.height;e.scale(s,a)}}}function Y(e,t){const i=t.anchorX||b.anchorX,s=t.anchorY||b.anchorY;if(t.rotation){const[r,n,a,o]=t.rect,l=r+a*i,h=n+o*s;e.translate(l,h),e.rotate(t.rotation),e.translate(-l,-h)}const r=t.scaleX||b.scaleX,n=t.scaleY||b.scaleY;if(1!==r||1!==n){const[a,o,l,h]=t.rect,c=a+l*i,u=o+h*s;let d=c,g=u;r<0&&(d=a+l/(1-r)),n<0&&(g=o+h/(1-n)),e.translate(d,g),e.scale(r,n),e.translate(-d,-g)}}function T(e,t){const i=t,{x:s,y:r,width:n,height:a}=i.getRect();e.save(),k(e,i),e.beginPath(),e.rect(s,r,n,a),e.lineWidth=1,e.strokeStyle="#60ACFC",e.stroke(),e.closePath(),e.restore()}class I{constructor(e,t){Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.x=e,this.y=t}add(e){return new I(this.x+e.x,this.y+e.y)}subtract(e){return new I(this.x-e.x,this.y-e.y)}}function N(e,t){let i,s,r;r="source"===t?e.getSource():e.getTarget(),i=e.getStyle(`edge.${t}.anchor.x`),s=e.getStyle(`edge.${t}.anchor.y`),i=void 0===i?b.anchorX:i,s=void 0===s?b.anchorY:s;const{x:n,y:a}=r.getPostion(),{width:o,height:l}=r.getSize(),{x:h,y:c}=r.getAnchor();return{x:n-o*h+o*i,y:a-l*c+l*s}}function C(e,t){const i=t.getSource(),s=t.getTarget();if(i&&s){e.save(),e.beginPath(),e.strokeStyle=t.getStyle("edge.color")||b.borderColor;const r=t.getStyle("edge.width")||b.borderWidth,n=t.getStyle("edge.cap"),a=t.getStyle("edge.join");e.lineJoin=a||b.borderJoin,e.lineWidth=r<=0?1:r,e.lineCap=n||b.borderCap;let o=N(t,"source"),l=N(t,"target");const h=i.getRotation(),c=s.getRotation();h&&(o=S(o,i.getPostion(),h)),c&&(l=S(l,s.getPostion(),c));const u=t.getStyle("edge.segments");if(u){const i=[...t.getStyle("edge.points")];i.unshift(o),i.push(l);const s=u.length;for(let t=0,r=0;t<s;t++){const s=u[t];if(1===s){const t=i[r++];e.moveTo(t.x,t.y)}else if(2===s){const t=i[r++];e.lineTo(t.x,t.y)}else if(3===s){const t=i[r++],s=i[r++];e.quadraticCurveTo(t.x,t.y,s.x,s.y)}else if(4===s){const t=i[r++],s=i[r++],n=i[r++];e.bezierCurveTo(t.x,t.y,s.x,s.y,n.x,n.y)}}}else e.moveTo(o.x,o.y),e.lineTo(l.x,l.y);e.stroke(),e.restore()}}const z=function(){const e={},t=document.createElement("canvas").getContext("2d");return function(i,s){t.font=i;let r=e[t.font];return r||(r=2*t.measureText("e").width+4,e[t.font]=r),{width:t.measureText(s).width+4,height:r}}}();function R(e,t){let i,s,r,n,a,o,l,h,c;e.save();const u=t;u.type?([i,s,r,n]=u.rect,({text:a,font:o,color:l,align:h,vAlign:c}=u)):(X(e,t),i=0,s=0,({width:r,height:n}=t.getSize()),a=t.getStyle("text"),o=t.getStyle("text.font"),l=t.getStyle("text.color"),h=t.getStyle("text.align"),c=t.getStyle("text.vAlign")),e.font=o||b.font;const d=z(e.font,a);e.textAlign="center",e.textBaseline="middle",e.fillStyle=l||b.fontColor,c=c||b.vAlign,h=h||b.align,l=l||b.fontColor,a=a||b.text;let g=0,f=0;f="top"===c?s+d.height/2:"middle"===c?s+n/2:s+n-d.height/2,g="right"===h?i+r-d.width/2:"left"===h?i+d.width/2:i+r/2,e.fillText(a,g,f),e.restore()}function A(e){const t=[],i=e.length;for(let s=0;s<i;s+=2)t.push({x:e[s],y:e[s+1]});return t}function W(e,t){let i,s,r;e.save();const n=t,a=t;if(n.className?(r=n.getPoints(),i=n.getSegments(),s=n.isClosePath()):(({segments:i,closePath:s}=a),r=A(a.points)),f(e,n),e.beginPath(),i&&i.length>0){const t=i.length;for(let n=0,a=0;n<t;n++){const t=i[n];if(1===t){const t=r[a++];e.moveTo(t.x,t.y)}else if(2===t){const t=r[a++];e.lineTo(t.x,t.y)}else if(3===t){const t=r[a++],i=r[a++];e.quadraticCurveTo(t.x,t.y,i.x,i.y)}else if(4===t){const t=r[a++],i=r[a++],s=r[a++];e.bezierCurveTo(t.x,t.y,i.x,i.y,s.x,s.y)}else 5===t&&e.closePath();s&&e.closePath()}}else{const t=r.length;if(t>0){let i=r[0];e.moveTo(i.x,i.y);for(let s=1;s<t;s++){const t=r[s];e.lineTo(t.x,t.y)}s&&e.closePath()}}const o=(n.className?n.getStyle("shape.border.width"):a.borderWidth)||0;0!==o&&(e.lineWidth=o,e.stroke());const l=n.className?n.getStyle("shape.background"):a.background,h=(a?a.fillRule:n.getStyle("shape.fill.rule"))||b.fillRule;l&&e.fill(h),e.restore()}function L(e,t){let i,s,r,n;e.save();const a=t;if(a.className)i=0,s=0,({width:r,height:n}=a.getSize());else{const e=t;[i,s,r,n]=e.rect}f(e,t),e.beginPath(),e.rect(i,s,r,n),e.closePath(),O(e,t),e.restore()}function E(e,t){let i,s,r,n,a,o,l;e.save();const h=t;if(h.className)i=0,s=0,({width:r,height:n}=h.getSize()),a=h.getStyle("shape.arc.from"),o=h.getStyle("shape.arc.to"),l=h.getStyle("shape.arc.close");else{const e=t;[i,s,r,n]=e.rect,({arcFrom:a,arcTo:o,arcClose:l}=e)}const c=Math.min(r,n)/2;f(e,t),e.beginPath();const u=i+r/2,d=s+n/2;e.arc(u,d,c,a,o),void 0!==l&&!0!==l||(e.lineTo(u,d),e.closePath()),O(e,t),e.restore()}function D(e,t){let i,s,r,n;e.save();const a=t;if(a.className)i=0,s=0,({width:r,height:n}=a.getSize());else{const e=t;[i,s,r,n]=e.rect}f(e,a),e.beginPath(),e.moveTo(i+r/2,s),e.lineTo(i+r,s+n),e.lineTo(i,s+n),e.lineTo(i+r/2,s),e.closePath(),e.stroke(),e.fill(),e.restore()}function B(e,t){let i,s,r,n;e.save();const a=t;if(a.className)i=0,s=0,({width:r,height:n}=a.getSize());else{const e=t;[i,s,r,n]=e.rect}f(e,t);const o=Math.min(r,n)/2;e.beginPath(),e.arc(i+r/2,s+n/2,o,0,2*Math.PI,!0),e.closePath(),O(e,t),e.restore()}function J(e,t){let i,s,r,n;e.save();const a=t;if(a.className)i=0,s=0,({width:r,height:n}=a.getSize());else{const e=t;[i,s,r,n]=e.rect}const o=r/2,l=n/2;e.beginPath();const h=l/o;o!==l&&e.scale(1,h),e.arc(i+o,(s+l)/h,o,0,2*Math.PI,!0),e.closePath(),e.restore(),e.save(),f(e,a),O(e,a),e.restore()}function H(e,t){let i,s,r,n,a;e.save();const o=t;if(o.className)i=0,s=0,({width:r,height:n}=o.getSize()),a=o.getImage();else{const e=t;[i,s,r,n]=e.rect,({name:a}=e)}if(a){const t=m(a);t&&e.drawImage(t,i,s,r,n)}e.restore()}var U=function(e,t,i,s){function r(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,n){function a(e){try{l(s.next(e))}catch(t){n(t)}}function o(e){try{l(s["throw"](e))}catch(t){n(t)}}function l(e){e.done?i(e.value):r(e.value).then(a,o)}l((s=s.apply(e,t||[])).next())}))};const V=new Map;class F{constructor(e){Object.defineProperty(this,"_canvas",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dataList",{enumerable:!0,configurable:!0,writable:!0,value:new l}),Object.defineProperty(this,"_notifier",{enumerable:!0,configurable:!0,writable:!0,value:new j}),Object.defineProperty(this,"_background",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dataMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"_lastId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_selection",{enumerable:!0,configurable:!0,writable:!0,value:new l}),Object.defineProperty(this,"_ro",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.createLowerCanvas(),e.editable&&this._initEventListeners(),this._notifier.on("render",(()=>{this.render()}))}getDataList(){return this._dataList}addData(e,t){e.setNotifier(this._notifier),e.getId()||e.setId(++this._lastId),this._dataMap.set(e.getId(),e),this._dataList.add(e,t),this.update()}getDataById(e){return this._dataMap.get(e)}load(e){return U(this,void 0,void 0,(function*(){const t=yield F.loadResource(e);this._deserialize(t)}))}_initEventListeners(){const e={x:0,y:0},t=t=>{const s=x(document.body,t),r=this.getDataList();if(r.size()>0){const t=new l;let i;for(let n=0;n<r.size();n++){const t=r.get(n);if("Edge"!==t.className){const r=t;let n=r.getRotation();const{x:a,y:o}=t.getPostion();let l=s.x,h=s.y;n&&({x:l,y:h}=S(s,r.getPostion(),-1*n));const c=t.getRect();P(c,l,h)&&(e.x=s.x-a,e.y=s.y-o,i=t)}}i&&t.add(i),0===this.getSelection().size()&&0===t.size()||this.setSelection(t)}document.addEventListener("mousemove",i,!1)},i=t=>{const i=this.getSelection(),s=x(document.body,t);i.size()>0&&i.each((t=>{const i={x:s.x-e.x,y:s.y-e.y};if("Shape"===(null===t||void 0===t?void 0:t.className)){const e=t,s=e.getPoints(),{x:r,y:n}=e.getPostion(),a=s.map((e=>{const t=new I(e.x,e.y),s=new I(i.x-r,i.y-n),a=t.add(s);return{x:a.x,y:a.y}}));e.setPoints(a)}t&&t.setPosition(Object.assign({},i))}))},s=e=>{document.removeEventListener("mousemove",i,!1)};document.addEventListener("mousedown",t,!1),document.addEventListener("mouseup",s,!1);const r=e=>{const t=x(this._canvas,e),i=this.getDataList();let s;for(let r=0;r<i.size();r++){const e=i.get(r);if("Edge"!==e.className){const i=e;let r=i.getRotation(),n=t.x,a=t.y;r&&({x:n,y:a}=S(t,i.getPostion(),-1*r));const o=i.getRect();if(P(o,n,a)){s=e;break}}}this._canvas.style.cursor=s?"pointer":"default"};this._canvas.addEventListener("mousemove",r,!1)}_deserialize(e){this._dataList.clear(),this._dataMap.clear();const t=e.p;t.background&&this.setBackground(t.background);const i=e.d,s=[],r=[];this._lastId=0;for(const a of i){const e=a.c.slice(a.c.indexOf(".")+1),t=a.i;t>=this._lastId&&(this._lastId=t);const i=y(e),n=new i;n.setId(t),this._dataMap.set(t,n),n.setNotifier(this._notifier),r.push(n),s.push(a)}const n=s.length;for(let a=0;a<n;a++){const e=r[a],t=s[a];this._deserializeData(e,t),this.addData(e)}}_deserializeData(e,t){const i=t.p||{},s=(t.a,t.s||{});for(const r in i){const t=w(r),s=i[r];e[t]&&e[t](this._deserializeValue(s))}for(const r in s){const t=s[r];e.setStyle(r,this._deserializeValue(t))}}_deserializeValue(e){if(void 0!==e&&null!==e)return e.__i?this.getDataById(e.__i):e.__a?e.__a:e}update(){this._notifier.emitNextTick("render")}render(){this._renderAllData()}_renderAllData(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._background&&(this._context.fillStyle=this._background,this._context.fillRect(0,0,this._canvas.width,this._canvas.height),this._context.restore());const e=this.getDataList(),t=e.size();for(let s=0;s<t;s++){const t=e.get(s);this._renderData(t)}const i=this.getSelection();i.each((e=>{e&&T(this._context,e)}))}_renderData(e){const t=e.className,i=this._context;switch(i.save(),t){case"Node":this._renderNode(e);break;case"Edge":this._renderEdge(e);break;case"Text":this._renderText(e);break;case"Shape":this._renderShape(e);break}i.restore()}_renderNode(e){const t=e.getImage(),i=e.getStyle("shape");!t||m(t)?(X(this._context,e),!t&&i?this._renderBasicShape(i,e):t&&(t.endsWith(".json")?this._renderSymbolImage(t,e):H(this._context,e))):F.loadImage([t]).then((()=>{this.update()}))}_renderBasicShape(e,t){switch(e){case"rect":L(this._context,t);break;case"circle":B(this._context,t);break;case"oval":J(this._context,t);break;case"triangle":D(this._context,t);break;case"arc":E(this._context,t);break;case"text":R(this._context,t);break;case"image":t.name&&t.name.endsWith(".json")?this._renderSymbolImage(t.name,t):H(this._context,t);break;case"shape":W(this._context,t);break}}_renderSymbolImage(e,t,i){const s=m(e),r=s.comps;if(this._context.save(),i&&s){const[e,t,r,n]=i.rect;this._context.translate(e,t);const a=r/s.width,o=n/s.height;this._context.scale(a,o)}if(r)for(const n of r)if("image"!==n.type)this._context.save(),Y(this._context,n),this._renderBasicShape(n.type,n),this._context.restore();else{const e=n.name,i=m(e);if(!i){F.loadImage([e]).then((()=>{this.update()}));continue}e.endsWith(".json")?(this._context.save(),Y(this._context,n),this._renderSymbolImage(e,t,n),this._context.restore()):(this._context.save(),Y(this._context,n),H(this._context,n),this._context.restore())}this._context.restore()}_renderEdge(e){const t=e.getSource(),i=e.getTarget(),s=[];t.getImage&&t.getImage()&&!m(t.getImage())&&s.push(t.getImage()),i.getImage&&i.getImage()&&!m(i.getImage())&&s.push(i.getImage()),s.length>0?F.loadImage(s).then((()=>{this.update()})):C(this._context,e)}_renderText(e){R(this._context,e)}_renderShape(e){k(this._context,e),W(this._context,e)}fitContent(){}mount(e){this._container=e||document.body,this._container.appendChild(this._canvas),this._ro=new ResizeObserver((e=>{for(const t of e){const{width:e,height:i}=t.contentRect,s=Math.floor(e),r=Math.floor(i);this._canvas.width=s,this._canvas.height=r,this._canvas.style.width=s+"px",this._canvas.style.height=r+"px",this.render()}})),this._ro.observe(this._container)}createLowerCanvas(){const e=document.createElement("canvas");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.right="0px",e.style.bottom="0px";const t=e.getContext("2d");if(!t)throw new Error("get 2d context failed");return this._context=t,this._canvas=e,this._canvas}static loadResource(e){return U(this,void 0,void 0,(function*(){const t=F.convertURL(e),i=yield fetch(t,{method:"GET"}),s=yield i.json();return s}))}static loadImage(e){return U(this,void 0,void 0,(function*(){const t=e.filter((e=>!0!==V.get(e))),i=t.map((e=>new Promise((t=>{if(V.set(e,!0),e.endsWith(".json"))this.loadResource(e).then((i=>{v(e,i),V.delete(e),t()}));else{const i=new Image;i.onload=()=>{v(e,i),V.delete(e),t()},e.startsWith("data:image")?i.src=e:i.src=F.convertURL(e)}}))));return Promise.all(i)}))}setBackground(e){this._background=e}getBackground(){return this._background}getSelection(){return this._selection}setSelection(e){this._selection=new l(e),this.update()}destory(){this._ro.disconnect(),this._dataList.clear(),this._dataMap.clear(),this._notifier.off("render")}}Object.defineProperty(F,"convertURL",{enumerable:!0,configurable:!0,writable:!0,value:e=>e});var $={GraphView:F,Node:c,Edge:d,Shape:g,Text:u},q=function(e,t,i,s){function r(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,n){function a(e){try{l(s.next(e))}catch(t){n(t)}}function o(e){try{l(s["throw"](e))}catch(t){n(t)}}function l(e){e.done?i(e.value):r(e.value).then(a,o)}l((s=s.apply(e,t||[])).next())}))},G=(0,r.aZ)({name:"App",components:{},mounted(){return q(this,void 0,void 0,(function*(){F.convertURL=e=>`storage/${e}`;const e=new $.GraphView({editable:!0});e.load("displays/basic.json"),e.mount(this.$refs.container),window.gv=e}))}});G.render=a;var Z=G;const K=(0,s.ri)(Z);K.mount("#app")}},t={};function i(s){var r=t[s];if(void 0!==r)return r.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,i),n.exports}i.m=e,function(){var e=[];i.O=function(t,s,r,n){if(!s){var a=1/0;for(c=0;c<e.length;c++){s=e[c][0],r=e[c][1],n=e[c][2];for(var o=!0,l=0;l<s.length;l++)(!1&n||a>=n)&&Object.keys(i.O).every((function(e){return i.O[e](s[l])}))?s.splice(l--,1):(o=!1,n<a&&(a=n));if(o){e.splice(c--,1);var h=r();void 0!==h&&(t=h)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[s,r,n]}}(),function(){i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,n,a=s[0],o=s[1],l=s[2],h=0;if(a.some((function(t){return 0!==e[t]}))){for(r in o)i.o(o,r)&&(i.m[r]=o[r]);if(l)var c=l(i)}for(t&&t(s);h<a.length;h++)n=a[h],i.o(e,n)&&e[n]&&e[n][0](),e[a[h]]=0;return i.O(c)},s=self["webpackChunkgraph"]=self["webpackChunkgraph"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=i.O(void 0,[998],(function(){return i(167)}));s=i.O(s)})();